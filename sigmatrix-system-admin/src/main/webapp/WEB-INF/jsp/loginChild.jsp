<%@page language="java" contentType="text/html; charset=UTF-8"  pageEncoding="UTF-8"%>
<%@ include file="/WEB-INF/jsp/common/title.jsp"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<title></title>
		<title></title>
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
		<meta http-equiv="description" content="This is my page">
		<style type="text/css">
			us{display:none;width:300px;height:40px;
	          padding:10px;position:relative;top:0px;left:50px;
	          background-color:#0099FF;
	        }
			body,p,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dt,dd,table,th,td,form,fieldset,legend,input,textarea,button,select{margin: 0;padding: 0;}
			body {font-family: 'microsoft yahei';}
			img,fieldset {border: 0;}
			ul,ol {list-style: none;}
			em,address {font-style: normal;}
			a {color: #000;text-decoration: none;}
			a,a:link,a:visited,a:hover {text-decoration: none;}
			.clear {clear: both;}
			table {border-collapse: collapse;border-spacing: 0;}
			.round{-moz-border-radius: 5px;-webkit-border-radius: 5px;border-radius: 5px;background: #43b4fd;color: #fff;height: 40px;line-height: 40px;text-align: center;cursor: pointer;}
			#login-kuang{width: 80%;margin: 0px auto;}
			.dd-login-{text-align: center;width: 100%;height:419px;background: url('<%=request.getContextPath() %>/images/register/login-pic-001.jpg') repeat-x;}
			.dd-login-1{position: relative;margin: 0px auto;width: 100%;}
			.dd-login-2{width: 557px;height: 43px;}
			.dd-login-3{width: 100%;height: 60px;text-align: right;height: 60px;vertical-align: middle;}
			.dd-login-4{float: right;}
			.dd-login-5{float: right;width: 120px;height: 60px;line-height: 60px;cursor: pointer;color: #7d7d7e;text-align: right;}
			.dd-login-6{float: right;width: 140px;height: 60px;line-height: 60px;cursor: pointer;color: #7d7d7e;text-align: right;}
			.dd-login-7{float: right;width: 379px;height: 359px;background: url('<%=request.getContextPath() %>/images/register/login-pic-003.png') repeat;}
			/* .dd-login-8{color: #fff;font-size: 18px;width: 90%;height: 124px;} */
			.dd-login-9{width: 90%;margin: 0px auto;border-bottom: 1px #e7e7eb solid;background: #fff;padding: 10px 0px;text-align: left;}
			.dd-login-10{vertical-align: top;margin-left: 20px;margin-right: 20px;}
			.dd-login-11{border: none;color:#7d7d7e;height: 25px;line-height: 25px;font-size: 14px;font-family: 'microsoft yahei';}
			.dd-login-12{width: 90%;margin: 0px auto;background: #fff;padding: 10px 0px;text-align: left;}
			.dd-login-13{width: 90%;margin: 10px auto 10px auto;}
			.dd-login-14{background: #dddede;width: 38%;text-align: center;}
			.dd-login-15{border: none;color:#7d7d7e;height: 25px;line-height: 25px;font-size: 14px;width: 70%;font-family: 'microsoft yahei';background: #dddede;}
			.dd-login-16{padding: 0px;font-size: 12px;color: #fff;text-align: center;}
			.dd-login-17{border: none;margin-left: 20px;}
			.dd-login-18{font-size: 12px;color: #000;margin-left: 10px;}
			.dd-login-19{width: 40%;}
			.dd-login-20{padding: 10px 0px;}
			.dd-login-21{font-size: 12px;color: #d8271c;margin-left: 20px;}
			.dd-login-22{text-decoration: underline;font-size: 12px;color: #d8271c;}
			.dd-login-23{margin: 0px auto;width: 80%;height: 271px;}
			.dd-login-24{height: 30px;}
			.dd-login-25{width: 100%;text-align: center;}
			.dd-login-26{width: 15%;border-right: 1px #666666 dotted;cursor: pointer;}
			.dd-login-27{font-size: 16px;color: #605e5e;text-align: center;width: 100%;}
			.dd-login-28{font-size: 12px;color: #9a9999;width: 90%;text-align: left;margin: 0px auto;padding: 10px 0px;}
			.dd-login-29{width: 15%;padding: 0px 3px;}
			.dd-login-30{width: 100%;background: #1e1e1e;height: 180px;text-align: center;padding: 0px 0px 20px 0px;}
			.dd-login-31{height: 50px;}
			.dd-login-32{margin: 0px auto;width: 280px;}
			.dd-login-33{padding: 0px 5px;}
			.dd-login-34{color: #fff;font-size: 18px;padding: 0px 5px;}
			.dd-login-35{height: 20px;}
			.dd-login-36{margin: 0px auto;width: 400px;}
			.dd-login-37{color: #fff;font-size: 12px;}
			.dd-login-38{float: left;width: 100px;cursor: pointer;}
			#close{vertical-align: middle;width: 16px;position: absolute;z-index: 2;top: 5px;right: 5px;cursor: pointer;}
			.dd-login-39{vertical-align: top;height: 27px;margin: 5px 0px;width:90px;cursor: pointer;}
			.dd-login-40{color:#000;font-size: 12px;}
			.dd-login-41{border: none;color:#7d7d7e;font-size: 14px;position:absolute;margin-top: 10px;}
			.aaa{color: white;}
			.bg_position{position: absolute;z-index: -100;left: 13%;top: 32%;width: 781px;}
		</style>
		
		<script type="text/javascript" language="javascript">
			$(document).ready(function(){
				if('${param.err}'!=''){
					sAlert(decodeURIComponent('${param.err}'));
				}
			    document.getElementById('passwordValue').onkeypress = detectCapsLock;
				tiao();
				var thisVal = '${loginName}';
				if (thisVal=="") {
						$("#loginName").val("登录名");
						$("#loginName").addClass("dd-login-11");
				}else{
					$("#loginName").val(thisVal);
				}
				thisVal = '${passWord}';
				if (thisVal=="") {
					$("#passwordValue").val("密码");
				}else{
					$("#passwordValue").val("******");
				}
				$("#passwordValue").bind("input keyup", function() {
					var passwordValue = $(this).val();
					var password = $("#loginPwd").val();
					var lastValue=passwordValue.substr(password.length,passwordValue.length);
					//全部删除
					if(passwordValue==""){
						$("#passwordValue").val("");
						$("#loginPwd").val("");
						return;
					}
					//删除操作
					else if(passwordValue.length<password.length && passwordValue.substr(-1,5)=="*"){
						$("#loginPwd").val(password.substr(0,password.length-1));
						return;
					}
					
					//首次输入/全部选中后重新输入(注：禁止部分选中或中间修改密码)/复制粘贴
					if(passwordValue.length==0 || passwordValue.indexOf("*")<0){
						$("#loginPwd").val(passwordValue);
					}
					else{
						$("#loginPwd").val(password+lastValue);
					}				
					var size =passwordValue.length;
					var newValue="";
					for(i=0;i<size;i++){
						newValue = newValue+"*";
					}
					$("#passwordValue").val(newValue);
				});
				
				
				$("input").keydown(function(e){
					var e = e || event,
					keycode = e.which || e.keyCode;
				   	if (keycode==13) {
					  $(".round").trigger("click");
					}
				});
			});
			
			var doc = document;
			
			//文本框光标定位
			function moveEnd(obj) {
				obj.focus();
				var len = obj.value.length;
				if (document.selection) {
					var sel = obj.createTextRange();
					sel.moveStart('character', len);
					sel.collapse();
					sel.select();
				} else if (typeof obj.selectionStart == 'number'
						&& typeof obj.selectionEnd == 'number') {
					obj.selectionStart = obj.selectionEnd = len;
				}
			}
				
			function sAlert(str){
			
				if(str!=null&&str=='LOGIN_FAILURE'){
					str="用户名或者密码错误";
				}else if(str!=null&&str=='CODE_FAILURE'){
					str="验证码错误";
				}
				var msgw,msgh,bordercolor;
				msgw=400;//提示窗口的宽度
				msgh=100;//提示窗口的高度
				titleheight=25 //提示窗口标题高度
				bordercolor="rgb(227,0,0)";//提示窗口的边框颜色#336699
				titlecolor="#99CCFF";//提示窗口的标题颜色
				var sWidth,sHeight;
				sWidth=document.body.offsetWidth;//浏览器工作区域内页面宽度
				sHeight=screen.height-77;//屏幕高度（垂直分辨率）
				//背景层（大小与窗口有效区域相同，即当弹出对话框时，背景显示为放射状透明灰色）
				var bgObj=document.createElement("div");//创建一个div对象（背景层）
				//定义div属性，即相当于
				//<div id="bgDiv" style="position:absolute; top:0; background-color:#777; filter:progid:DXImagesTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=75); opacity:0.6; left:0; width:918px; height:768px; z-index:10000;"></div>
				bgObj.setAttribute('id','bgDiv');
				bgObj.style.position="absolute";
				bgObj.style.top="0";
				bgObj.style.background="#777";
				bgObj.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=75";
				bgObj.style.opacity="0.6";
				bgObj.style.left="0";
				bgObj.style.width="100%";
				bgObj.style.height="100%";
				bgObj.style.zIndex = "10000";
				document.body.appendChild(bgObj);//在body内添加该div对象
				var msgObj=document.createElement("div")//创建一个div对象（提示框层）
				//定义div属性，即相当于
				//<div id="msgDiv" align="center" style="background-color:white; border:1px solid #336699; position:absolute; left:50%; top:50%; font:12px/1.6em Verdana,Geneva,Arial,Helvetica,sans-serif; margin-left:-225px; margin-top:npx; width:400px; height:100px; text-align:center; line-height:25px; z-index:100001;"></div>
				msgObj.setAttribute("id","msgDiv");
				msgObj.setAttribute("align","center");
				msgObj.style.background="white";
				msgObj.style.border="1px solid " + bordercolor;
				msgObj.style.position = "absolute";
				msgObj.style.left = "50%";
				msgObj.style.top = "50%";
				msgObj.style.font="12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif";
				msgObj.style.marginLeft = "-225px" ;
				msgObj.style.marginTop = -75+document.documentElement.scrollTop+"px";
				msgObj.style.width = msgw + "px";
				msgObj.style.height =msgh + "px";
				msgObj.style.textAlign = "center";
				msgObj.style.lineHeight ="25px";
				msgObj.style.zIndex = "10001";
				var title=document.createElement("h4");//创建一个h4对象（提示框标题栏）
				//定义h4的属性，即相当于
				//<h4 id="msgTitle" align="right" style="margin:0; padding:3px; background-color:#336699; filter:progid:DXImageTransform.Microsoft.Alpha(startX=20, startY=20, finishX=100, finishY=100,style=1,opacity=75,finishOpacity=100); opacity:0.75; border:1px solid #336699; height:18px; font:12px Verdana,Geneva,Arial,Helvetica,sans-serif; color:white; cursor:pointer;" onclick="">关闭</h4>
				title.setAttribute("id","msgTitle");
				title.setAttribute("align","right");
				title.style.margin="0";
				title.style.padding="3px";
				title.style.background=bordercolor;
				title.style.filter="progid:DXImageTransform.Microsoft.Alpha(startX=20, startY=20, finishX=100,finishY=100,style=1,opacity=75,finishOpacity=100);";
				title.style.opacity="0.75";
				title.style.border="1px solid rgb(184,208,214)";
				title.style.height="18px";
				title.style.font="12px Verdana, Geneva, Arial, Helvetica, sans-serif";
				title.style.cursor="pointer";
				title.innerHTML="关闭";
				title.onclick=removeObj;
				
				function removeObj(){//点击标题栏触发的事件
					document.body.removeChild(bgObj);//删除背景层Div
					document.getElementById("msgDiv").removeChild(title);//删除提示框的标题栏
					document.body.removeChild(msgObj);//删除提示框层
				}
				document.body.appendChild(msgObj);//在body内添加提示框div对象msgObj
				document.getElementById("msgDiv").appendChild(title);//在提示框div中添加标题栏对象title
				var txt=document.createElement("p");//创建一个p对象（提示框提示信息）
				//定义p的属性，即相当于
				//<p style="margin:1em 0;" id="msgTxt">烈火网-网页特效效果</p>
				txt.style.margin="1em 0";
				txt.style.fontSize="14px";
				txt.setAttribute("id","msgTxt");
				txt.innerHTML=str;//来源于函数调用时的参数值
				document.getElementById("msgDiv").appendChild(txt);//在提示框div中添加提示信息对象txt
			}
			
			function removeObj(){//点击标题栏触发的事件
				$("#bgDiv").remove();
				$("#msgDiv").remove();
				$("#msgTitle").remove();
				$("#msgTxt").remove();
			}
			
			function loginBug(){
	      		var loginName = $("#loginName").val();
	      		var LoginForm = document.getElementsByName("LoginForm")[0];
	      		removeObj();
				for(i=0;i<loginName.length;i++){
					if(loginName.charCodeAt(i)==39){
						sAlert("用户名或密码错误");
						return false;
					}
				}
				return Validator.Validate(LoginForm,2);
	      	}
	
		      function loginMsg( msgNum,accountId){
		      	removeObj();
		        switch( msgNum ){
		          case "1":
		            sAlert("登陆名无效!");
		            break;
		          case "2":
		            sAlert("账号还未注册！");
		            break;
		          case "3":
		            sAlert("密码错误！");
		            break;
		          case "4":
		            sAlert("验证码错误！");
		            break;
		          case "5":
		            sAlert("账号冻结！");
		            break;
		          default:
		            break;
		        }
		      }
		      
		    // 验证码跳转
			function tiao() {
				document.getElementById("img").src = "<%=request.getContextPath()%>/authImg?random="
						+ Math.random();
			}
		     
		    function check(){
				var result = true;
				var errorMsg = "";
				removeObj();
				if($("#loginName").val()==""){
					errorMsg = "登录失败：请填写登录账户！";
					result = false;
				}
				else if($("#loginPwd").val()==""){
					errorMsg = "登录失败：请填写登录密码！";
					result = false;
				}
				else if($("#validCode").val()=="" || $("#validCode").val()=="验证码"){
					errorMsg = "登录失败：请填写验证码！";
					result = false;
				}else if($("#passwordValue").val()==""||$("#passwordValue").val()=="密码"){
					errorMsg = "登录失败：请填写登录密码！";
					result = false;
				}
				if(!result){
					sAlert(errorMsg);
				}
				return result;
			} 
			
	        function Submit(){
				if(check()){
	      	  		$("#LoginForm").submit();
	      	  	}
	        }
	        
	        $(document).keydown(function(e){
				var e = e || event,
				keycode = e.which || e.keyCode;
			    if (keycode == 37) {
			        return false;
			    }
			    if (keycode == 38) {
			        return false;
			    }
			    if (keycode == 39) {
			        return false;
			    }
			});
			function change(num){
		        $("#"+num).find("img").attr("src","<%=request.getContextPath() %>/images/register/login-pic-"+num+".png");
			}
		function  detectCapsLock(event){
            var e = event||window.event;
            var o = e.target||e.srcElement;
            var oTip = o.nextSibling;
            var keyCode  =  e.keyCode||e.which; // 按键的keyCode 
            var isShift  =  e.shiftKey ||(keyCode  ==   16 ) || false ; // shift键是否按住
            if (
                   ((keyCode >=   65   &&  keyCode  <=   90 )  &&   !isShift) // Caps Lock 打开，且没有按住shift键 
                   || ((keyCode >=   97   &&  keyCode  <=   122 )  &&  isShift)// Caps Lock 打开，且按住shift键
                   )
                 {
                      $("#capsLock").show();
                 }
            else{
                      $("#capsLock").hide();
            } 
        }
		</script>
	</head>

	<body onload="" style="background: #dff0ff;text-align: center;">
		<!-- logo -->
		<div style="width: 100%;background: #47bf24;">
			<div style="width: 80%;margin: 0px auto;">
				<table style="width: 100%;">
					<tr style="border:0px solid #666">
						<td style="height: 103px;line-height: 103px;text-align: left;">
							<img src="<%=request.getContextPath() %>/images/enterpriseLogo/${enterprise.code}/${enterprise.enterprisePic}" class="dd-login-2" style="vertical-align: middle;"/>
						</td>
					</tr>			
				</table>
			</div>
		</div>
		<div style="width: 100%;background-color: rgb(208, 249, 196);margin: 13% 0px;">
			<div class="bg_position"><img src="<%=request.getContextPath() %>/images/register/bg_position.png"/></div>
			<div id="login-kuang" style="position: relative;">
				<img src="<%=request.getContextPath() %>/images/register/login-pic-006.png" style="width: 515px;
float: left;"/>
				<form id="LoginForm" name="LoginForm" action="${ctx}submitLogin"
					onsubmit="return loginBug();" method="post">
					<div style="float: right;width: 379px;">
						<div class="dd-login-8">&nbsp;</div>
						<div class="dd-login-9">
							<img src="<%=request.getContextPath() %>/images/register/login-pic-004.png" class="dd-login-10"/>
							<input id="loginName" name="loginName" type="text" class="dd-login-11" value="${loginName}" onBlur="if(value==''){value='登录名'}" onFocus="if(value=='登录名'){value =''}"/>
						</div>
						<div class="dd-login-12" style="position: relative;">
								<img src="<%=request.getContextPath() %>/images/register/login-pic-005.png" class="dd-login-10"/>
								<input id="passwordValue" name="passwordValue" type="text" value="${coverPwd }" class="dd-login-11" autocomplete="off" onclick="moveEnd(this);" onBlur="if(value==''){value='密码'}" onfocus="if(value=='密码'){value =''}"/>
								<input id="loginPwd" name="passWord" type="hidden" value="${passWord }"/>
						</div>
							<div id="capsLock" class="dd-login-12" style="text-align: center;display: none;">
							<span style="color: #a10000 " >大写锁定键被按下，请注意大小写</span>
						</div>
						<table class="dd-login-13">
							<tr style="border:0px solid #666">
								<td class="dd-login-14">
									<input id="validCode" name="validCode" type="text" class="dd-login-15" value="验证码" autocomplete="off" onBlur="if(value==''){value='验证码'}" onFocus="if(value=='验证码'){value =''}"/>
								</td>
								<td class="dd-login-16">
									<div style="background: #dddede;width: 90%;margin: 0px auto;">
										<!-- 验证码图片 -->
									   	<img id="img" src="" onclick="tiao();" class="dd-login-39"/>
									</div>
								</td>
								<td class="dd-login-16"><a href="#" class="dd-login-40" onclick="tiao();" style="text-decoration: underline;">看不清，换一张</a></td>
							</tr>
						</table>
						<table class="dd-login-13">
							<tr style="border:0px solid #666">
								<td class="dd-login-19">
									<div class="round" onclick="Submit();" style="font-size: 14px;background: #47bf24;">登  录</div>
								</td>
								<td style="width: 30%;text-align: right;padding-right: 10px;font-size: 12px;color: #000;height: 44px;line-height: 44px;"><input type="checkbox" class="dd-login-17" name="rememberPwd" value="1" <c:if test="${rememberPwd==1 }">checked="checked"</c:if> />&nbsp;&nbsp;记住密码</td>
								<!-- <td style="width: 30%;text-align: left;padding-left: 10px;height: 44px;line-height: 44px;"><a href="account!findPassword.html" class="dd-login-18">忘记密码?</a></td> -->
							</tr>
						</table>
					</div>
					<div class="clear"></div>
				</form>
			</div>
		</div>
		<div style="position: absolute;/* bottom: 0px; */background-color:#2b2b2b;font-size: 12px;color: #fef0e5;width: 100%;text-align: center;height: 100px;line-height: 100px;">京ICP证150232号&nbsp;&nbsp;京ICP备10042933号&nbsp;&nbsp;京公网安备11010102001494号 </div>
	</body>
</html>